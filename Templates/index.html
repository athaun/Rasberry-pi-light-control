<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <title>Asher's Light</title> 
        <link rel="shortcut icon" type="image/x-icon" href="{{ favicon }}"/>
        <link rel="stylesheet" type="text/css" href="{{ css }}">
    </head>
    <body>

        <form method="post" action="/" id="form">
            <button id="switch" type="submit" value="lightSwitch" name="lightSwitch"/>
                <img id="bulbImg" src="{{ off }}" alt="Light is off">
            </button>
        </form>

        <script src="https://code.jquery.com/jquery-3.5.1.js"
          integrity="sha256-QWo7LDvxbWT2tbbQ97B53yJnYU3WhH/C8ycbRAkjPDc="
          crossorigin="anonymous"></script>
 
    <script type="text/javascript">
        let currentState = "{{ lightOn }}" == "False" ? false : true
        console.log("As of page load, the \"light on\" state is: " + currentState)

        $(document).on('submit', '#form', function(e) {
            e.preventDefault();
            $.ajax({
                type:'POST',
                url:'/',
                data: $("#switch").val(),
                success:function() {
                    currentState = !currentState
                    if (currentState == true) {
                        // Light is on
                        $("#bulbImg").attr("src","{{ on }}");
                        console.log("The light is now on")
                    } else {
                        $("#bulbImg").attr("src","{{ off }}");
                        console.log("The light is now off")
                    }
                }
            })
        });
    </script>
    </body>
</html>
